<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>Paper Title (use style: paper title)</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:等线;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@等线";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	text-align:center;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
h1
	{margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	text-align:center;
	text-indent:0cm;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-variant:small-caps;
	font-weight:normal;}
h2
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:14.4pt;
	text-indent:-14.4pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:normal;
	font-style:italic;}
h3
	{margin:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:14.4pt;
	line-height:12.0pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:normal;
	font-style:italic;}
h4
	{margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:25.2pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-weight:normal;
	font-style:italic;}
h5
	{margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	text-align:center;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	font-variant:small-caps;
	font-weight:normal;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"页脚 字符";
	margin:0cm;
	text-align:center;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin:0cm;
	text-align:center;
	font-size:10.0pt;
	font-family:"Calibri Light",sans-serif;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-link:"正文文本 字符";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:14.4pt;
	line-height:95%;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	letter-spacing:-.05pt;}
p.Abstract, li.Abstract, div.Abstract
	{mso-style-name:Abstract;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:13.6pt;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;}
p.Author, li.Author, div.Author
	{mso-style-name:Author;
	margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	text-align:center;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;}
span.a
	{mso-style-name:"正文文本 字符";
	mso-style-link:正文文本;
	letter-spacing:-.05pt;}
p.papertitle, li.papertitle, div.papertitle
	{mso-style-name:"paper title";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:center;
	font-size:24.0pt;
	font-family:"Times New Roman",serif;}
p.references, li.references, div.references
	{mso-style-name:references;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:2.5pt;
	margin-left:18.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-18.0pt;
	line-height:9.0pt;
	font-size:8.0pt;
	font-family:"Times New Roman",serif;}
p.Keywords, li.Keywords, div.Keywords
	{mso-style-name:Keywords;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:13.7pt;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;
	font-weight:bold;
	font-style:italic;}
span.a0
	{mso-style-name:"页脚 字符";
	mso-style-link:页脚;}
.MsoChpDefault
	{font-size:10.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:27.0pt 44.65pt 72.0pt 44.65pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.3pt 841.9pt;
	margin:22.5pt 44.65pt 72.0pt 44.65pt;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:595.3pt 841.9pt;
	margin:22.5pt 44.65pt 72.0pt 44.65pt;}
div.WordSection3
	{page:WordSection3;}
@page WordSection4
	{size:595.3pt 841.9pt;
	margin:54.0pt 45.35pt 72.0pt 45.35pt;}
div.WordSection4
	{page:WordSection4;}
@page WordSection5
	{size:595.3pt 841.9pt;
	margin:54.0pt 44.65pt 72.0pt 44.65pt;}
div.WordSection5
	{page:WordSection5;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN style='word-wrap:break-word'>

<div class=WordSection1>

<p class=papertitle><span lang=EN-US>SNS Project Report: Forecast COVID-19
Vaccination Status</span></p>

<p class=Author style='line-height:50%'><span lang=EN-US style='font-size:8.0pt;
line-height:50%'>&nbsp;</span></p>

</div>

<span lang=EN-US style='font-size:8.0pt;line-height:50%;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:auto'>
</span>

<div class=WordSection2><span lang=EN-US style='font-size:9.0pt;font-family:
"Times New Roman",serif'><br clear=all>
</span>

<p class=Author><span lang=EN-US style='font-size:9.0pt'>Studet Name: Haonan
Shen<br>
Student Number: <i>17049189</i><br>
&nbsp;Electronic and Electrical Engineering <br>
Email: zceehsh@ucl.ac.uk</span></p>

<span lang=EN-US style='font-size:9.0pt;font-family:"Times New Roman",serif'><br
clear=all>
</span>

<p class=Author><span lang=EN-US>&nbsp;</span></p>

</div>

<span lang=EN-US style='font-size:10.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:auto'>
</span>

<div class=WordSection3><br clear=all>
</div>

<span lang=EN-US style='font-size:10.0pt;font-family:"Times New Roman",serif'><br
clear=all style='page-break-before:auto'>
</span>

<div class=WordSection4>

<p class=Abstract><i><span lang=EN-US>Abstract</span></i><span lang=EN-US>― This
SNS project report offers a systematic analysis to predict the number of
British citizen who will be received the first dose of COVID-19 vaccinations in
United Kingdom. The workflow includes extracting and storing the correct
features from the raw dataset through open source API; time series analysis
with re- framing and decompose the sequence behavior; finally examining deep learning
neural network techniques to forecast the future vaccination outcome in python
programming language.</span></p>

<p class=Keywords><span lang=EN-US>Keywords―forecast, vaccination time series,
deep learning, LSTM network.</span></p>

<h1 style='margin-left:0cm;text-indent:0cm'><span lang=EN-US style='font-variant:
normal !important'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>I.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-variant:normal !important;text-transform:uppercase'>Introduction:
General background</span></h1>

<p class=MsoBodyText><span lang=X-NONE>Since the rapid outbreak of coronavirus
disease (COVID-19) in late 2019, its global impact has been profound. Public
health scientists believe that the COVID-19 is the most serious respiratory
virus in modern age since the H1N1 Influenza pandemic. Until March 2021, there
are approximately 4.3 Million infection cases and over 120 thousand death cases
in United Kingdom. The inevitable consequence of the pandemic have been
significant in the field of health, economy and society. As with many other
diseases, most patients that were infected with the COVID-19 will experience
mild to moderate respiratory sickness and recover without special medical
treatment. However, the situation might become fatal for the vulnerable groups,
including older people, because of their poor immune system. This virus is
extremely aggressive for those people who have underlying medical conditions
such as diabetes, </span><span lang=X-NONE>cardiovascular</span><span
lang=EN-GB> disease and cancer. [1] The pandemic is not only one that is
creating a severe global economic slowdown, but also one that put citizen’s
life in danger. Allowing the virus to grow exponentially would lead to impacts,
in terms of loss of life and ill health, that would be considered intolerable
for society.</span></p>

<p class=MsoBodyText><span lang=EN-GB>On the other hand, one important
parameter was introduced at the beginning of the pandemic, which is called the
reproduction number, i.e., the R value. The aim is to reduce the R value below
one, that means every ten patients will infect less than 10 other people. This
is a feasible solution to the pandemic because there will be not enough people
to sustain the outbreak. Also, the rate of spread will decrease and eventually
stop. In the last year, the UK government releases several constraints in order
to bring down the R value, this includes mandatory face masks wearing in public
and localised city lockdown.&nbsp; Despite these methods are effective to
control the COVID-19 spreading, one cannot neglect the negative economic impact
of some extreme methods. For example, the lockdown is super effective, but it
is not a long-term strategy for a country to return to normal. Hence, a
vaccination programme is essential, just like the one started on January in the
UK. It is another way to lower the R value, but there is minor impact on the
economy comparing to lockdown. The motivation of the vaccination is simple:
although the pandemic first emerged over a year ago, the vast majority of the
British citizen are still vulnerable. A vaccine provides antibody to protect
people from the infected patient so to lower the spreading rate and prevent
more deaths of the old.</span></p>

<p class=MsoBodyText><span lang=EN-GB>This report focuses on the patterns
generated from the number of vaccination data as well as extracting implicit
knowledge from those patterns to forecast the future behaviour of the
vaccinated people number. The prediction system is developed by the recurrent
neural network (RNN) as well as the deep learning techniques in python
programming language.</span></p>

<p class=MsoBodyText><b><span lang=EN-GB>Goal </span></b><span lang=EN-GB>Forecast
how many British people will get vaccinated based on a predictive deep learning
algorithm.</span></p>

<p class=MsoBodyText><b><span lang=EN-GB>Objectives </span></b><span
lang=EN-GB>The entire workflow is organized as:</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-GB>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Understand the basic principle behind the
forecasting mechanism.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-GB>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Case study begins, collect vaccination data
source via API.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-GB>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Store vaccination data in local and cloud
database</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-GB>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Vaccination data pre-process for deep learning</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-GB>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-GB>Vaccination data patterns discovery &amp;
forecast</span></p>

<h1 style='margin-left:0cm;text-indent:0cm'><span lang=EN-US style='font-variant:
normal !important'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>II.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-variant:normal !important;text-transform:uppercase'>theory
and principle</span></h1>

<p class=MsoBodyText><span lang=X-NONE>The core aspect of this forecasting
project is the knowledge of neural network. This section illustrates a brief
overview of the key mechanic of general neural network, recurrent network and
the Long Short Term Memory network.</span></p>

<h2><span lang=EN-US>A.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><b><span
lang=EN-US>General Nerual Network</span></b></h2>

<p class=MsoNormal style='text-indent:14.4pt;page-break-after:avoid'><span
lang=EN-US>The idea of neural network came from the mimic of human brain on a
computer. The human body can be thinking of a combination of infinite nerve
cells or neurons. For example, the eyes are able to accepts stimulation from
the real world, this input stimulation enables neurons to produce an electric
signal, this signal will be passed to the next neuron or the next layer (hidden
layer), eventually reaches the brain within a nanosecond.</span><span
lang=EN-US style='font-family:宋体'> <img width=306 height=139 id="图片 1"
src="SNS_First_HTML.files/image001.gif" alt="IMG_256"></span></p>

<p class=MsoCaption><span lang=EN-US style='font-family:"Times New Roman",serif'>Figure
</span><span
lang=EN-US style='font-family:"Times New Roman",serif'>1</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> A general neural
network model</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:14.4pt'><span
lang=EN-GB style='letter-spacing:-.05pt'>Hence, the neural network can be
defined as “a set of algorithms, modeled loosely after the human brain, that
are designed to recognize patterns.” [2] The design of the neural network works
in a similar way, the network is made of different nodes, which are the place
where computation happens. The figure below shows a detailed representation of
one node:</span></p>

<p class=MsoNormal style='text-indent:14.4pt;page-break-after:avoid'><span
lang=EN-US style='font-family:"Calibri",sans-serif'><img width=275 height=133
id="图片 2" src="SNS_First_HTML.files/image002.jpg" alt="IMG_256"></span></p>

<p class=MsoCaption><span lang=EN-US style='font-family:"Times New Roman",serif'>Figure
</span><span
lang=EN-US style='font-family:"Times New Roman",serif'>2</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> A node in Neural
Network</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:14.4pt'><span
lang=EN-GB style='letter-spacing:-.05pt'>As depicted in this figure, each input
electric signals are related with corresponding weights. The reason behind this
is that not all the neuron activations are important for the brain. Depends on
what function the brain will perform, the neural network will select the
optimum allocation between signals and weights. After selected key signals,
these signals will be added together as a net input. The final step is called
“Activation function”. This measures the “strength” of the input neurons, the
output will only exist when there’s enough stimulation of the input. Common
activation functions includes sigmoid function and hyperbolic tanh function,
these will be discussed in the following sections. All the aspects make the
neural network suitable for process sequential data, such as sentense, sound
spectrogram and most importantly, time series.</span></p>

<p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Hlk67665447"><span lang=EN-US>B.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><b><span lang=EN-US>Recurrent Neural Network</span></b></a></h2>

<p class=MsoBodyText><span lang=X-NONE>In this project, an advanced recurrent
neural netw</span><span lang=EN-US>or</span><span lang=X-NONE>k (RNN) is being
used instead of the simple neural network discussed before. This is because the
time series forecasting focuses on the correlation between current data and
historical data, this requires the “memory” property of the network. The RNN
address this issue . Figure # shows the loop configuration of the RNN, the
rectangular stands for a chunk of neural network A with input xt and output ht.
A loop allows the information to be transferred from one step to the next,
makes the information persistent.</span></p>

<p class=MsoBodyText align=center style='text-align:center;page-break-after:
avoid'><span lang=X-NONE style='font-size:8.0pt;line-height:95%;font-family:
"Calibri",sans-serif'><img width=308 height=81 id="图片 4"
src="SNS_First_HTML.files/image003.gif" alt="IMG_256"></span></p>

<p class=MsoCaption><span lang=EN-US style='font-family:"Times New Roman",serif'>Figure
</span><span
lang=EN-US style='font-family:"Times New Roman",serif'>3</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> An Expaned RNN</span></p>

<p class=MsoBodyText><span lang=EN-US>If we expand the loop: this is a more
intuitive representation. RNN consists of multiple copies of the same network,
each one passing the input to the successor. On the other hand, the chain-like
configuration makes RNN related to lists and sequences, another natural
architecture to process time series data!</span></p>

<p class=MsoBodyText><span lang=EN-US>Although it seems that RNN can handle the
forecasting problem, the shortcoming is its long-term dependency. A classical
example considering the machine tries to predict the last word in a sentence:
“I grew up in France... I speak fluent French.” The normal neural network will
suggest the last word to be the name of a language, but it has no idea which
language is the best choice. In this circumstance, RNN becomes unable to
connect the information, a different network architecture is needed.</span></p>

<h2><span lang=EN-US>C.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><b><span
lang=EN-US>Long Short Term Memory Network</span></b></h2>

<p class=MsoBodyText><span lang=EN-US>LSTM, the Long Short Term Memory
networks, are a special kind of RNN, it is explicitly designed to compensate
the issue of long-term dependency. To explain the mechanism of LSTM, one must
focus on the repeating module as shown in the Figure below.</span></p>

<p class=MsoBodyText align=center style='text-align:center;page-break-after:
avoid'><span lang=X-NONE style='font-size:12.0pt;line-height:95%;font-family:
"Calibri",sans-serif'><img width=185 height=181
src="SNS_First_HTML.files/image004.gif" alt="IMG_256"></span></p>

<p class=MsoCaption><span lang=EN-US style='font-family:"Times New Roman",serif'>Figure
</span><span
lang=EN-US style='font-family:"Times New Roman",serif'>4</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> LSTM Internal Mechanism</span></p>

<p class=MsoBodyText><span lang=X-NONE>The most important parameter in LSTM is
called the cell state. It is represented by the horizontal line located on the
top of the figure. The cell state stores and carries the information of
previous events, it is regulated by the gates. The gates, which consists a
sigmoid function and a multiplication module, is a way to optionally let
information through since the output range of the sigmoid function is between
zero and one. Overall, an LSTM network has three gates.</span></p>

<p class=MsoBodyText><span lang=EN-US>To understand the internal process of the
LSTM, a brief overview of four stages are listed below:</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Discard information: The very first step of LSTM
is to identify the unnecessary memory, this decision is controlled by the
sigmoid function which is also called the forget gate layer. Two inputs are
accepted, output of the previous block h(t-1)as well as the current input xt.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Store information. The sigmoid layer determine
which information are needed to update, then the hyperbolic tanh layer creates
candidate value to be added to the cell state.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Update cell state. With the previous defined
updated data, the old state is multiplied by a function to forget discarded
information in step one; then add the candidate values in step two to create
current cell state.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Determine the output. The sigmoid layer is used
for decide which part of the cell state is going to output, then the output
cell state will go through the hyperbolic tanh multiplied by the sigmoid gate
output, so only the desired part will be produced in the end.</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=X-NONE>&nbsp;</span></p>

<h1 style='margin-left:0cm;text-indent:0cm'><span lang=EN-US style='font-variant:
normal !important'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>III.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-variant:normal !important;text-transform:uppercase'>case
stydy: vaccination number prediction</span></h1>

<p class=MsoBodyText><span lang=X-NONE>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US>Entire stages of the forecasting process are illustrated in this
section, including data information, collection, storage and preprocess. Notice
that all related codes are included in the next section IV only.</span></p>

<h2><span lang=EN-US>A.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><b><span
lang=EN-US>Data Description</span></b></h2>

<p class=MsoBodyText><span lang=X-NONE>The dataset used in this case study is
the number of British citizen who received the first dose of COVID-19 vaccine
in United Kingdom from January 2021 to March 2021. A time series is a sequence
of observations taken sequentially in time (Box et al.,2015). Unlike the
ordinary dataset which contains observations only, the time series adds a time
dimension with explicit order dependency. This additional dimension provides a
source of additional information. Time is an important concept in the field of
deep learning, it allows future prediction when the actual outcome may not be
known and is based on reliable analyze of all prior observations.</span></p>

<p class=MsoBodyText><span lang=X-NONE>The&nbsp; time series can be accessed
via the GOV.UK public API (application programming interface) and it is
structured as the format of DataFrame temporarily. The DataFrame is a type of
data structure in the pandas library, it has two dimensions composed of rows
and columns. Each row represents a data entry and each column stands for
different data features.</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=X-NONE>To be more
specific, the Vaccination number raw stock dataset consists of five columns and
74 rows. Those features includes date, area type, area code, area name and the
actual number of vaccination. For the further process of this stock dataset,
the stock dataset is downloaded and stored as a CSV (comma-separated values)
file with a size of 8 KB (Kilobyte). This data format can make the upcoming
tasks easier to be tackled with.</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=X-NONE>&nbsp;</span></p>

<h2><span lang=EN-US>B.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><b><span
lang=EN-US>Data</span><span lang=EN-US> </span></b><b><span lang=EN-US>Acquisition</span></b></h2>

<p class=MsoBodyText><span lang=X-NONE>The</span><span lang=EN-US> vaccination
number dataset can be easily collected through the GOV.UK API utilizing pandas
library built in method “read_csv”. Simply enter the permanent link of the
vaccination number time series into the “filepath_or_buffer” variable position,
then we can customize varieties of options to import the data as we want.</span></p>

<h2><span lang=EN-US>C.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><b><span
lang=EN-US>Data Storage</span></b></h2>

<p class=MsoBodyText><span lang=EN-US>There are two methods we can use to store
the vaccination time series dataset properly for the future use. That is, store
locally or upload to the cloud.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Local storage</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=EN-US>To store the vaccination
time series at local, one can simply use the pandas “tocsv” method. This
transforms the collected vaccination DataFrame to a csv file, then stores it to
the local work directory.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Cloud storage</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=EN-US>Another method to
save the stock price data is to use an on- line database. For this case study,
the mongoDB Atlas cloud database is adopted. Unlike famous relational-oriented
SQL databases like Oracle, mongoDB is a document-oriented database system which
has NoSQL behavior. It does not support traditional tabular data structure, but
stores dataset within “collections” as different “documents”. Since the
datasets in this project are acquired online, there are un- certainties about
the data content that is likely to make the data unstructured. Furthermore, the
dataset is going to be cleaned and modified before the machine learning
process, it is more convenient to store the file in an unstructured way. After
setting up the mongoDB Atlas cloud service, one can upload or download the time
series dataset using “mongoimport” or “mongoexport”.</span></p>

<h2><span lang=EN-US>D.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><b><span
lang=EN-US>Data Preprocessing</span></b></h2>

<p class=MsoBodyText style='text-indent:0cm'><span lang=EN-US>All essential
data preparation steps before the actual stock forecasting are discussed in
this section.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Clean</span></p>

<p class=MsoBodyText><span lang=EN-US>Typically, the very first task to process
the raw dataset is to verify the completeness of the information. In this case,
the target is the missing (referred to as Na) values within the vaccination time
series data.</span></p>

<p class=MsoBodyText><span lang=EN-US>Useful commands such as df.info(), which returns
a concise summary of the stock DataFrame including number of features,
observations and non-null values; df.isnull returns the boolean expression
“True” if there is any missing values detected within the DataFrame. After
applying these methods, it is confirmed that this data does not contain missing
values.</span></p>

<p class=MsoBodyText><span lang=EN-US>The next step is to confirm there is no
anomalies. Boxplot is a great tool to judge if there is any outliers or not
within the dataset. However, for this project the vaccination number time series
is provided by the GOV.UK official website and the dataset itself represents
the number of people. So it is not necessary to calculate the statistics of the
dataset and to identify anomalies.</span></p>

<p class=MsoBodyText><span lang=EN-US>The last step is to focus on which
feature is the project target. In this case, the column with the number of
people who received the first dose of COVID-19 vaccine is required. Hence, one
must change the multivariate time series into a univariate dataset with the
number of people and the dates only, this can be achieved by using the drop
command.</span></p>

<p class=MsoBodyText style='margin-left:35.4pt;text-indent:-21.0pt'><span
lang=EN-US>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Visualize &amp; Normalize</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=EN-US>For time series
analysis and forecasting, visualization plays an important role. Raw sample
data plots help to identify temporal patterns that can affect model choice,
such as trends, cycles, and seasonality. For the time series visualization,
line plots of observations over time are common, also there are a variety of
other plots to analyze the dataset.</span></p>

<p class=MsoBodyText align=center style='text-align:center;text-indent:0cm;
page-break-after:avoid'><span lang=EN-US><img width=493 height=265 id="图片 5"
src="SNS_First_HTML.files/image005.gif" alt="图表, 折线图&#10;&#10;描述已自动生成"></span></p>

<p class=MsoCaption><span lang=EN-US style='font-family:"Times New Roman",serif'>Figure
</span><span
lang=EN-US style='font-family:"Times New Roman",serif'>5</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> Line Plot: Vaccination
Time Series</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=EN-US>The number of
British people who received the first dose of COVID-19 vaccination is shown in the
figure above, we can see that there is a clear seasonality behind our time series.
To analyze the behavior deeply, the time series decomposition is essential. This
method reveals the hidden pattern behind the data set, including trend,
seasonality and residual.</span></p>

<p class=MsoBodyText align=center style='text-align:center;text-indent:0cm;
page-break-after:avoid'><span lang=EN-US><img width=523 height=259 id="图片 6"
src="SNS_First_HTML.files/image006.gif" alt="图片包含 图形用户界面&#10;&#10;描述已自动生成"></span></p>

<p class=MsoCaption><span lang=EN-US style='font-family:"Times New Roman",serif'>Figure
</span><span
lang=EN-US style='font-family:"Times New Roman",serif'>6</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> Vaccination Time Series
Decomposition</span></p>

<p class=MsoBodyText style='text-indent:14.9pt'><span lang=EN-US>There are two
basic conclusions from the time series decomposition diagrams. The first is
that there will be more people receive the first dose of vaccine in the future,
the second is that there is a clear seasonality that more people prefer to get
vaccinated during the weekends rather during the weekdays. </span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Now
the last thing before process the data into neural network is called
normalization. The reason to do this is that the scale for our vaccination people
time series is too large, if we do not normalize it the neural network tends to
be confused at later stages. The solution is simple, divide each single data
point by the largest value, so all data points lie between zero and one. The
normalization can be achieved by the MinMaxScaler in skleran library. We need
to fit then transform the training data set, the transformation is given by:</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span
lang=EN-US style='font-size:10.5pt;font-family:等线'><img width=398 height=15
src="SNS_First_HTML.files/image007.gif"></span></p>

<p class=MsoBodyText style='text-indent:0cm'><span
lang=EN-US style='font-size:10.5pt;font-family:等线'><img width=207 height=15
src="SNS_First_HTML.files/image008.gif"></span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=EN-US>&nbsp;</span></p>

<h1 style='margin-left:0cm;text-indent:0cm'><span lang=EN-US style='font-variant:
normal !important'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>IV.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-variant:normal !important;text-transform:uppercase'>code
and results</span></h1>

<p class=MsoNormal align=left style='text-align:left;background:#2B2B2B'><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>pandas </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>as </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>pd<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>numpy </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>as </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>np<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>matplotlib.pyplot </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>as </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>plt<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>matplotlib </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>dates<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>statsmodels.tsa.seasonal
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>seasonal_decompose<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>pylab </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>rcParams<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>sklearn.preprocessing
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>MinMaxScaler<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>keras.preprocessing.sequence
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>TimeseriesGenerator<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>keras.models </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>Sequential<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>keras.layers </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>Dense<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>from </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>keras.layers </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>import </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>LSTM<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'># Data
Collection and Clean<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>url=</span><span
lang=EN-US style='font-family:"Courier New";color:#6A8759'>&quot;https://api.coronavirus.data.gov.uk/v2/data?areaType=overview&amp;metric=newPeopleVaccinatedFirstDoseByPublishDate&amp;format=csv&quot;<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>df =
pd.read_csv(url</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>index_col</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'date'</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>parse_dates</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>True</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>)<br>
df.dropna(</span><span lang=EN-US style='font-family:"Courier New";color:#AA4926'>inplace</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>True</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>)<br>
df.drop([</span><span lang=EN-US style='font-family:"Courier New";color:#6A8759'>'areaType'</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#6A8759'>'areaCode'</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#6A8759'>'areaName'</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>]</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>axis</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>1</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>inplace</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>True</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>)<br>
df.sort_values(</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'date'</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>inplace</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>True</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>)<br>
df.rename(</span><span lang=EN-US style='font-family:"Courier New";color:#AA4926'>columns</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>={</span><span
lang=EN-US style='font-family:"Courier New";color:#6A8759'>&quot;newPeopleVaccinatedFirstDoseByPublishDate&quot;</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>: </span><span
lang=EN-US style='font-family:"Courier New";color:#6A8759'>&quot;numVaccinated&quot;</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>}</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>inplace</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>True</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>)<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'># Line
plot<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>title =
</span><span lang=EN-US style='font-family:"Courier New";color:#6A8759'>'Line
Plot of New People Get First Dose of Vaccination Daily'<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>ylabel
= </span><span lang=EN-US style='font-family:"Courier New";color:#6A8759'>'Number
of People'<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>xlabel
= </span><span lang=EN-US style='font-family:"Courier New";color:#6A8759'>'Date'<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>ax =
df[</span><span lang=EN-US style='font-family:"Courier New";color:#6A8759'>'numVaccinated'</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>].plot(</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>c </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>= </span><span
lang=EN-US style='font-family:"Courier New";color:#6A8759'>'g'</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>lw</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>3</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>figsize</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=(</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>12</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>6</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>)</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>title</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=title)<br>
ax.autoscale(</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>axis</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'y'</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>tight</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>True</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>)<br>
ax.yaxis.grid(</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>True</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>)<br>
ax.xaxis.grid(</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>True</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>)<br>
ax.legend(</span><span lang=EN-US style='font-family:"Courier New";color:#AA4926'>loc</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>2</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>fontsize</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>14</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>)<br>
ax.set_ylabel(</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'Number of People'</span><span lang=EN-US style='font-family:
"Courier New";color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>fontdict</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>={</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'fontsize'</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>:</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>24</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>})<br>
ax.set_xlabel(</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'Date'</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>fontdict</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>={</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'fontsize'</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>:</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>24</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>})<br>
ax.set_title(title</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>pad</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>20</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>, </span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>fontdict</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>={</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'fontsize'</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>:</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>24</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>})<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'>#plt.show()<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>results
= seasonal_decompose(df[</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>'numVaccinated'</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>])<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'>#rcParams['figure.figsize']
= 10,5<br>
#results.plot();<br>
<br>
############### FORECAST THE NEXT 7 DAYS BEGINS ##################<br>
<br>
# First normalize the data<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>train =
df.iloc[:</span><span lang=EN-US style='font-family:"Courier New";color:#8888C6'>len</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>(df)-</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>7</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>]<br>
test = df.iloc[</span><span lang=EN-US style='font-family:"Courier New";
color:#8888C6'>len</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>(df)-</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>7</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>:]<br>
scaler = MinMaxScaler()<br>
scaler.fit(train)<br>
scaled_train = scaler.transform(train)<br>
scaled_test = scaler.transform(test)<br>
<br>
n_input = </span><span lang=EN-US style='font-family:"Courier New";color:#6897BB'>7
</span><span lang=EN-US style='font-family:"Courier New";color:gray'># This is
the length of our training dataset<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>n_features
= </span><span lang=EN-US style='font-family:"Courier New";color:#6897BB'>1 </span><span
lang=EN-US style='font-family:"Courier New";color:gray'># Predict one point in
the future<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>train_generator
= TimeseriesGenerator(scaled_train</span><span lang=EN-US style='font-family:
"Courier New";color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>scaled_train</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>length</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=n_input</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>batch_size</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>1</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>)<br>
<br>
</span></p>

<p class=MsoNormal align=left style='text-align:left;background:#2B2B2B'><span
lang=EN-US style='font-family:"Courier New";color:gray'># Choose our model activation
function as ReLu(Rectified Linear Unit) &amp; Loss function as Mean Squared Error</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'><br>
model = Sequential()<br>
model.add(LSTM(</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>150</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>activation</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>’relu’</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>, </span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>input_shape</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=(n_input</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>n_features))) </span><span lang=EN-US style='font-family:"Courier New";
color:gray'># 150 neurons<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>model.add(Dense(</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>1</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>))<br>
model.compile(</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>optimizer</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>’adam’</span><span lang=EN-US style='font-family:"Courier New";
color:#CC7832'>,</span><span lang=EN-US style='font-family:"Courier New";
color:#AA4926'>loss</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>=</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>’mse’</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>)<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'>#model.summary()<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>model.fit_generator(train_generator</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>epochs</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>100</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>)<br>
myloss = model.history.history[</span><span lang=EN-US style='font-family:"Courier New";
color:#6A8759'>‘loss’</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>]<br>
plt.plot(</span><span lang=EN-US style='font-family:"Courier New";color:#8888C6'>range</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>(</span><span
lang=EN-US style='font-family:"Courier New";color:#8888C6'>len</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>(myloss))</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>myloss)<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'># Now, use
7 history steps to predict the eighth one<br>
# In another words use last 7 points in the training data to predict the first
point in the test data<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>first_eval_batch
= scaled_train[-</span><span lang=EN-US style='font-family:"Courier New";
color:#6897BB'>7</span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>:]<br>
first_eval_batch = first_eval_batch.reshape((</span><span lang=EN-US
style='font-family:"Courier New";color:#6897BB'>1</span><span lang=EN-US
style='font-family:"Courier New";color:#CC7832'>,</span><span lang=EN-US
style='font-family:"Courier New";color:#A9B7C6'>n_input</span><span lang=EN-US
style='font-family:"Courier New";color:#CC7832'>,</span><span lang=EN-US
style='font-family:"Courier New";color:#A9B7C6'>n_features))<br>
model.predict(first_eval_batch)<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'># FORECAST
MECHANISM<br>
<br>
# Create predictions<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>test_predictions
= []<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'># Grab the
evaluation batch, use last n_input points from the training dataset<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>first_eval_batch
= scaled_train[-n_input:]<br>
current_batch = first_eval_batch.reshape((</span><span lang=EN-US
style='font-family:"Courier New";color:#6897BB'>1</span><span lang=EN-US
style='font-family:"Courier New";color:#CC7832'>,</span><span lang=EN-US
style='font-family:"Courier New";color:#A9B7C6'>n_input</span><span lang=EN-US
style='font-family:"Courier New";color:#CC7832'>,</span><span lang=EN-US
style='font-family:"Courier New";color:#A9B7C6'>n_features))<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'>#
len(test) is how far we will forecast into the future<br>
</span><span lang=EN-US style='font-family:"Courier New";color:#CC7832'>for </span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>I </span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>in </span><span
lang=EN-US style='font-family:"Courier New";color:#8888C6'>range</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>(</span><span
lang=EN-US style='font-family:"Courier New";color:#8888C6'>len</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>(test)):<br>
<br>
&nbsp;&nbsp;&nbsp; </span><span lang=EN-US style='font-family:"Courier New";
color:gray'># One step ahead of 7 historical points<br>
&nbsp;&nbsp;&nbsp; </span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>current_pred = model.predict(current_batch)[</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>0</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>]<br>
&nbsp;&nbsp;&nbsp; </span><span lang=EN-US style='font-family:"Courier New";
color:gray'># Store the prediction<br>
&nbsp;&nbsp;&nbsp; </span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>test_predictions.append(current_pred)<br>
&nbsp;&nbsp;&nbsp; </span><span lang=EN-US style='font-family:"Courier New";
color:gray'># Update the current batch with our prediction<br>
&nbsp;&nbsp;&nbsp; </span><span lang=EN-US style='font-family:"Courier New";
color:#A9B7C6'>current_batch = np.append(current_batch[:</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>1</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>:</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>:]</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>[[current_pred]]</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#AA4926'>axis</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>1</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>)<br>
<br>
</span><span lang=EN-US style='font-family:"Courier New";color:gray'>#
Transform the test prediction to the actual number of people</span></p>

<p class=MsoNormal align=left style='text-align:left;background:#2B2B2B'><span
lang=EN-US style='font-family:"Courier New";color:gray'># Also plot the
comparison <br>
</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>true_predictions
= scaler.inverse_transform(test_predictions)<br>
test[</span><span lang=EN-US style='font-family:"Courier New";color:#6A8759'>‘Predictions
7 days’</span><span lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>]
= true_predictions<br>
test.plot(</span><span lang=EN-US style='font-family:"Courier New";color:#AA4926'>figsize</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>=(</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>12</span><span
lang=EN-US style='font-family:"Courier New";color:#CC7832'>,</span><span
lang=EN-US style='font-family:"Courier New";color:#6897BB'>5</span><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>))<br>
plt.show()</span></p>

<p class=MsoNormal align=left style='text-align:left;background:#2B2B2B'><span
lang=EN-US style='font-family:"Courier New";color:#A9B7C6'>test['Accuracy'] = (1
- abs(test['Predictions 7 days']-test['numVaccinated']) / test['numVaccinated'])
* 100</span></p>

<p class=MsoBodyText style='text-indent:0cm'><span lang=X-NONE>&nbsp;</span></p>

<p class=MsoBodyText align=center style='text-align:center;page-break-after:
avoid'><span lang=X-NONE><img width=591 height=267 id="图片 7"
src="SNS_First_HTML.files/image009.gif" alt="图表, 折线图&#10;&#10;描述已自动生成"></span></p>

<p class=MsoCaption><span lang=EN-US style='font-family:"Times New Roman",serif'>Figure
</span><span
lang=EN-US style='font-family:"Times New Roman",serif'>7</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> Line Plot of Forecast
for the Next Week</span></p>

<p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>The
figure above depicts the plot of the predicted curve (yellow) and the actual
data. We can see that with 100 epochs and 150 neurons in our LSTM model, the
predicted value is not perfectly accurate, but its general trend does follow
the actual data. Table of accuracy based on days in advance is:</span></p>

<p class=MsoCaption style='page-break-after:avoid'><span lang=EN-US
style='font-family:"Times New Roman",serif'>Table </span><span
lang=EN-US style='font-family:"Times New Roman",serif'>1</span><span
lang=EN-US style='font-family:"Times New Roman",serif'> Prediction Accuracy Description
Based on LSTM</span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US>Days in advance</span></b></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US>Accuracy</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>1</span></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>64.747%</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>2</span></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>63.747%</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>3</span></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>63.476%</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>4</span></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>61.737%</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>5</span></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>55.628%</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>6</span></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>90.709%</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>7</span></p>
  </td>
  <td width=162 valign=top style='width:121.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>74.742%</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
style='color:white'>T</span><span lang=EN-US>he general idea is that the forecast
is more difficult as the prediction period increases, the last two points have
higher accuracy is because we go back to weekdays again, the vaccination number
is more stable. To conclude this project report, we have successfully created a
forecast mechanism for the vaccination time series data based on the Long Short
Term Memory technique under the neural network. The result of prediction
suggests that people should accept the COVID-19 vaccination soon and reduce the
virus spreading in the country.</span></p>

<h5><span lang=EN-US style='font-variant:normal !important;text-transform:uppercase'>References</span></h5>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
lang=EN-US>&nbsp;</span></p>

<p class=references style='margin-left:17.7pt;text-indent:-17.7pt'><span
lang=EN-US>[1]<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US>G. Eason, B. Noble, and I. N. Sneddon, “On certain integrals of
Lipschitz-Hankel type involving products of Bessel functions,” Phil. Trans.
Roy. Soc. London, vol. A247, pp. 529C551, April 1955. <i>(references)</i></span></p>

<p class=references><span lang=EN-US>&nbsp;</span></p>

</div>

<b><span lang=X-NONE style='font-size:10.0pt;font-family:"Times New Roman",serif;
color:red;letter-spacing:-.05pt'><br clear=all style='page-break-before:auto'>
</span></b>

<div class=WordSection5>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

</div>

</body>

</html>
